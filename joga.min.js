// JogaJS v0.2.0
// (c) 2014 Nicolas Font http://jogajs.com
// License: MIT
!function(){function e(){Function.prototype.bind||(Function.prototype.bind=function(e){if("function"!=typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var t=Array.prototype.slice.call(arguments,1),i=this,n=function(){},s=function(){return i.apply(this instanceof n&&e?this:e,t.concat(Array.prototype.slice.call(arguments)))};return n.prototype=this.prototype,s.prototype=new n,s})}var t,i,n;!function(e){function s(e,t){return j.call(e,t)}function o(e,t){var i,n,s,o,r,a,l,h,u,c,p,d=t&&t.split("/"),f=b.map,m=f&&f["*"]||{};if(e&&"."===e.charAt(0))if(t){for(d=d.slice(0,d.length-1),e=e.split("/"),r=e.length-1,b.nodeIdCompat&&x.test(e[r])&&(e[r]=e[r].replace(x,"")),e=d.concat(e),u=0;u<e.length;u+=1)if(p=e[u],"."===p)e.splice(u,1),u-=1;else if(".."===p){if(1===u&&(".."===e[2]||".."===e[0]))break;u>0&&(e.splice(u-1,2),u-=2)}e=e.join("/")}else 0===e.indexOf("./")&&(e=e.substring(2));if((d||m)&&f){for(i=e.split("/"),u=i.length;u>0;u-=1){if(n=i.slice(0,u).join("/"),d)for(c=d.length;c>0;c-=1)if(s=f[d.slice(0,c).join("/")],s&&(s=s[n])){o=s,a=u;break}if(o)break;!l&&m&&m[n]&&(l=m[n],h=u)}!o&&l&&(o=l,a=h),o&&(i.splice(0,a,o),e=i.join("/"))}return e}function r(t,i){return function(){return d.apply(e,E.call(arguments,0).concat([t,i]))}}function a(e){return function(t){return o(t,e)}}function l(e){return function(t){g[e]=t}}function h(t){if(s(y,t)){var i=y[t];delete y[t],v[t]=!0,p.apply(e,i)}if(!s(g,t)&&!s(v,t))throw new Error("No "+t);return g[t]}function u(e){var t,i=e?e.indexOf("!"):-1;return i>-1&&(t=e.substring(0,i),e=e.substring(i+1,e.length)),[t,e]}function c(e){return function(){return b&&b.config&&b.config[e]||{}}}var p,d,f,m,g={},y={},b={},v={},j=Object.prototype.hasOwnProperty,E=[].slice,x=/\.js$/;f=function(e,t){var i,n=u(e),s=n[0];return e=n[1],s&&(s=o(s,t),i=h(s)),s?e=i&&i.normalize?i.normalize(e,a(t)):o(e,t):(e=o(e,t),n=u(e),s=n[0],e=n[1],s&&(i=h(s))),{f:s?s+"!"+e:e,n:e,pr:s,p:i}},m={require:function(e){return r(e)},exports:function(e){var t=g[e];return"undefined"!=typeof t?t:g[e]={}},module:function(e){return{id:e,uri:"",exports:g[e],config:c(e)}}},p=function(t,i,n,o){var a,u,c,p,d,b,j=[],E=typeof n;if(o=o||t,"undefined"===E||"function"===E){for(i=!i.length&&n.length?["require","exports","module"]:i,d=0;d<i.length;d+=1)if(p=f(i[d],o),u=p.f,"require"===u)j[d]=m.require(t);else if("exports"===u)j[d]=m.exports(t),b=!0;else if("module"===u)a=j[d]=m.module(t);else if(s(g,u)||s(y,u)||s(v,u))j[d]=h(u);else{if(!p.p)throw new Error(t+" missing "+u);p.p.load(p.n,r(o,!0),l(u),{}),j[d]=g[u]}c=n?n.apply(g[t],j):void 0,t&&(a&&a.exports!==e&&a.exports!==g[t]?g[t]=a.exports:c===e&&b||(g[t]=c))}else t&&(g[t]=n)},t=i=d=function(t,i,n,s,o){if("string"==typeof t)return m[t]?m[t](i):h(f(t,i).f);if(!t.splice){if(b=t,b.deps&&d(b.deps,b.callback),!i)return;i.splice?(t=i,i=n,n=null):t=e}return i=i||function(){},"function"==typeof n&&(n=s,s=o),s?p(e,t,i,n):setTimeout(function(){p(e,t,i,n)},4),d},d.config=function(e){return d(e)},t._defined=g,n=function(e,t,i){t.splice||(i=t,t=[]),s(g,e)||s(y,e)||(y[e]=[e,t,i])},n.amd={jQuery:!0}}(),n("../node_modules/almond/almond",function(){}),n("joga/dependencyTracker",[],function(){function e(){this.observers=[],this.push=function(e){return this.observers.push(e),this},this.pop=function(){return this.observers.pop(),this},this.notify=function(e){return this.observers.length>0&&this.observers[this.observers.length-1](e),this}}return new e}),n("joga/objectProperty",["joga/dependencyTracker"],function(e){function t(e){function t(e){return t.evaluate(e,this)}return t.evaluate=i,t.initialize=n,t.mixinTo=s,t.applySelf=o,t.subscribe=r,t.unsubscribe=a,t.notify=l,t.isNull=h,t.isNotNull=u,t.get=c,t.put=p,t.forEach=d,t.initialize(e),t}function i(t,i){return this.self=i,void 0===t?(e.notify(this),this.value):(this.value=t,this.notify(),this.self)}function n(e){this.value=null,this.observers=[],this.evaluate(e)}function s(e){var t;for(t in this)e[t]=this[t];return this}function o(e){return this.apply(this.self,e)}function r(e){return this.observers.push(e),this}function a(e){var t=this.observers.indexOf(e);return-1!==t&&this.observers.splice(t,1),this}function l(){var e,t=this.observers.slice(0);for(e=0;e<t.length;e++)t[e](this);return this}function h(){return null===this.applySelf()}function u(){return!this.isNull()}function c(e){return this.applySelf()[e]}function p(e,t){this.value[e]=t,this.notify()}function d(e){var t;for(t in this.applySelf())e.call(this.self,this.value[t],t)}return t}),n("joga/arrayProperty",["joga/objectProperty"],function(e){function t(t){function c(e){return c.evaluate(e,this)}return e().mixinTo(c),c.push=i,c.pop=n,c.remove=s,c.clear=o,c.shift=r,c.unshift=a,c.reverse=l,c.sort=h,c.forEach=u,c.initialize(t),c}function i(e){return this.value.push(e),this.notify(),this}function n(){var e=this.value.pop();return this.notify(),e}function s(e){for(var t=this.value.indexOf(e);-1!==t;)this.value.splice(t,1),t=this.value.indexOf(e);return this.notify(),this}function o(){return this.applySelf([[]]),this.notify(),this}function r(){var e=this.applySelf().shift();return this.notify(),e}function a(e){return this.applySelf().unshift(e),this.notify(),this}function l(){return this.applySelf().reverse(),this.notify(),this}function h(e){return this.applySelf().sort(e),this.notify(),this}function u(e){var t;if(this.applySelf().forEach)this.value.forEach(e.bind(this.self));else for(t=0;t<this.value.length;t++)e.call(this.self,this.value[t],t);return this}return t}),n("joga/booleanProperty",["joga/objectProperty"],function(e){function t(t){function n(e){return n.evaluate(e,this)}return e().mixinTo(n),n.toggle=i,n.initialize(t),n}function i(){return this.evaluate(!this.value),this}return t}),n("joga/computedProperty",["joga/objectProperty","joga/dependencyTracker"],function(e,t){function i(t){function i(e){return i.evaluate(e,this)}return e().mixinTo(i),i.evaluate=n,i.initialize=s,i.applyWrapped=o,i.initialize(t),i}function n(e,i){var n;if(this.self=i,void 0!==e)return this.value=e,this.self;for(n=0;n<this.dependencies.length;n++)this.dependencies[n].unsubscribe(this.notify);for(this.dependencies=[],this.wrapped=null,t.push(this.subscriber),this.value=this.computer.apply(this.self,arguments),t.pop(),n=0;n<this.dependencies.length;n++)this.dependencies[n].subscribe(this.notify);return t.notify(this),this.value}function s(t){e().initialize.call(this,null),this.computer=t,this.dependencies=[],this.notify=function(){var e,t=this.observers.slice(0);for(e=0;e<t.length;e++)t[e](this);return this.self}.bind(this),this.subscriber=function(e){-1===this.dependencies.indexOf(e)&&this.dependencies.push(e),this.wrapped=e}.bind(this),this.evaluate(t)}function o(e){return this.wrapped.apply(this.self,e),this.self}return i}),n("joga/bindings/ElementBinding",["joga/computedProperty"],function(e){function t(e,t){this.element=e,this.model=t}function i(){if(this.foreach.dataExpression&&this.do.dataExpression){var i=e(function(){var e,t=this.foreach.dataExpression.apply(this.model),i=[];for(e=0;e<t.length;e++)i.push(this.do.dataExpression.apply(t[e]));return i}.bind(this));this.foreach.update=function(){var e,n=i();for(t.removeChildNodes(this.element),e=0;e<n.length;e++)this.element.appendChild(n[e])}.bind(this),this.foreach.update(),i.subscribe(this.foreach.update)}}return t.removeChildNodes=function(e){for(;e.firstChild;)e.removeChild(e.firstChild)},t.prototype.child=function(i){var n=e(i);this.child.update=function(){t.removeChildNodes(this.element),this.element.appendChild(n.apply(this.model))}.bind(this),this.child.update(),n.subscribe(this.child.update)},t.prototype.childnodes=function(i){var n,s=e(i);this.childnodes.update=function(){var e=s.apply(this.model);for(t.removeChildNodes(this.element),n=0;n<e.length;n++)this.element.appendChild(e[n])}.bind(this),this.childnodes.update(),s.subscribe(this.childnodes.update)},t.prototype.class=function(t){var i=e(t);this.class.update=function(){this.class.lastClassName&&this.element.classList.remove(this.class.lastClassName),this.class.lastClassName=i.apply(this.model),this.element.classList.add(this.class.lastClassName)}.bind(this),this.class.update(),i.subscribe(this.class.update)},t.prototype.do=function(e){this.do.dataExpression=e,i.apply(this)},t.prototype.id=function(t){var i=e(t);this.id.update=function(){this.element.id=i.apply(this.model)}.bind(this),this.id.update(),i.subscribe(this.id.update)},t.prototype.foreach=function(e){this.foreach.dataExpression=e,i.apply(this)},t.prototype.onclick=function(e){this.element.onclick=function(t){t.preventDefault?t.preventDefault():t.returnValue=!1,e.call(this.model)}.bind(this)},t.prototype.text=function(i){var n=e(i);this.text.update=function(){t.removeChildNodes(this.element),this.element.appendChild(document.createTextNode(n.apply(this.model)))}.bind(this),this.text.update(),n.subscribe(this.text.update)},t.prototype.title=function(t){var i=e(t);this.title.update=function(){this.element.title=i.apply(this.model)}.bind(this),this.title.update(),i.subscribe(this.title.update)},t}),n("joga/bindings/HTMLAnchorElementBinding",["joga/bindings/ElementBinding","joga/computedProperty"],function(e,t){function i(t,i){e.call(this,t,i)}return i.prototype=new e,i.prototype.href=function(e){var i=t(e);this.href.update=function(){this.element.href=i.apply(this.model)}.bind(this),this.href.update(),i.subscribe(this.href.update)},i}),n("joga/bindings/HTMLFormElementBinding",["joga/bindings/ElementBinding","joga/computedProperty"],function(e){function t(t,i){e.call(this,t,i)}return t.prototype=new e,t.prototype.onsubmit=function(e){var t=function(t){var i=e.call(this.model);return i?i:(t.preventDefault?t.preventDefault():event.returnValue=!1,!1)}.bind(this);this.element.addEventListener?this.element.addEventListener("submit",t,!1):this.element.attachEvent&&this.element.attachEvent("onsubmit",t)},t}),n("joga/bindings/HTMLInputElementBinding",["joga/bindings/ElementBinding","joga/computedProperty"],function(e,t){function i(t,i){e.call(this,t,i)}function n(){if(this.hasOwnProperty("selectedvalue")&&this.hasOwnProperty("selected")){var e=t(this.selectedvalue.dataExpression),i=t(this.selected.dataExpression);this.selected.update=function(){this.element.checked=e.apply(this.model)===i.apply(this.model)}.bind(this),this.selected.update(),this.element.onchange=function(){i.applyWrapped(this.element.checked?[e.apply(this.model)]:[null])}.bind(this),e.subscribe(this.selected.update),i.subscribe(this.selected.update)}}return i.prototype=new e,i.prototype.checked=function(e){var i=t(e);this.checked.update=function(){this.element.checked=i.apply(this.model),this.element.onchange=function(){i.applyWrapped([this.element.checked])}.bind(this)}.bind(this),this.checked.update(),i.subscribe(this.checked.update)},i.prototype.value=function(e){var i=t(e);this.value.update=function(){this.element.value=i.apply(this.model)}.bind(this),this.value.update(),this.element.onchange=function(){i.applyWrapped([this.element.value])}.bind(this),i.subscribe(this.value.update)},i.prototype.selectedvalue=function(e){this.selectedvalue.dataExpression=e,n.apply(this)},i.prototype.selected=function(e){this.selected.dataExpression=e,n.apply(this)},i}),n("joga/bindings/HTMLImageElementBinding",["joga/bindings/ElementBinding","joga/computedProperty"],function(e,t){function i(t,i){e.call(this,t,i)}return i.prototype=new e,i.prototype.src=function(e){var i=t(e);this.src.update=function(){this.element.src=i.apply(this.model)}.bind(this),this.src.update(),i.subscribe(this.src.update)},i.prototype.alt=function(e){var i=t(e);this.alt.update=function(){this.element.alt=i.apply(this.model)}.bind(this),this.alt.update(),i.subscribe(this.alt.update)},i}),n("joga/bindings/HTMLSelectElementBinding",["joga/bindings/ElementBinding","joga/computedProperty"],function(e,t){function i(t,i){e.call(this,t,i)}i.prototype=new e;var n=function(){this.foreach.dataExpression&&(this.foreach.selected=t(function(){return this.selected.dataExpression?this.selected.dataExpression.apply(this.model):null}.bind(this)),this.foreach.models=t(function(){return this.foreach.dataExpression.apply(this.model)}.bind(this)),this.foreach.textFor=function(e){return this.text.dataExpression?this.text.dataExpression.apply(e):String(e)}.bind(this),this.foreach.select=function(e){this.selected.dataExpression&&this.foreach.selected.applyWrapped([e])}.bind(this),this.foreach.options=t(function(){var e,t,i=[];for(t=0;t<this.foreach.models().length;t++)e=document.createElement("option"),e.text=this.foreach.textFor(this.foreach.models()[t]),i.push(e);return i}.bind(this)),this.foreach.onElementChange=function(){var e,t=[];if(this.element.multiple){for(e=0;e<this.element.childNodes.length;e++)this.element.childNodes[e].selected&&t.push(this.foreach.models()[e]);this.foreach.select(t)}else this.foreach.select(this.foreach.models()[this.element.selectedIndex])}.bind(this),this.foreach.onModelsChange=function(){var t,i=this.foreach.options(),n=this.foreach.selected(),s=!1;for(e.removeChildNodes(this.element),t=0;t<i.length;t++)this.element.appendChild(i[t]),(this.element.multiple&&n&&-1!==n.indexOf(this.foreach.models()[t])||n===this.foreach.models()[t])&&(i[t].selected=!0,s=!0);s||this.foreach.select(this.element.multiple?[]:this.foreach.models().length>0?this.foreach.models()[0]:null)}.bind(this),this.foreach.onSelectedChange=function(){var e,t,i=this.element.childNodes,n=this.foreach.selected(),s=!1;for(e=0;e<i.length;e++)this.element.multiple&&n&&-1!==n.indexOf(this.foreach.models()[e])||n===this.foreach.models()[e]?(i[e].selected=!0,s=!0):i[e].selected=!1;s||(this.element.multiple?(t=[],(null===n||0!==n.length)&&this.foreach.select(t)):(t=this.foreach.models().length>0?this.foreach.models()[0]:null,n!==t&&this.foreach.select(t)))}.bind(this),this.foreach.onModelsChange(),this.element.onchange=this.foreach.onElementChange,this.foreach.models.subscribe(this.foreach.onModelsChange),this.foreach.options.subscribe(this.foreach.onModelsChange),this.foreach.selected.subscribe(this.foreach.onSelectedChange))};return i.prototype.foreach=function(e){this.foreach.dataExpression=e,n.apply(this)},i.prototype.text=function(e){this.text.dataExpression=e,n.apply(this)},i.prototype.selected=function(e){this.selected.dataExpression=e,this.foreach.onSelectedChange&&this.foreach.onSelectedChange()},i}),n("joga/bindings/HTMLTextAreaElementBinding",["joga/bindings/ElementBinding","joga/computedProperty"],function(e,t){function i(t,i){e.call(this,t,i)}return i.prototype=new e,i.prototype.value=function(e){var i=t(e);this.value.update=function(){this.element.value=i.apply(this.model)}.bind(this),this.value.update(),this.element.onchange=function(){i.applyWrapped([this.element.value])}.bind(this),i.subscribe(this.value.update)},i}),n("joga/elementBinder",["joga/bindings/ElementBinding","joga/bindings/HTMLAnchorElementBinding","joga/bindings/HTMLFormElementBinding","joga/bindings/HTMLInputElementBinding","joga/bindings/HTMLImageElementBinding","joga/bindings/HTMLSelectElementBinding","joga/bindings/HTMLTextAreaElementBinding"],function(e,t,i,n,s,o,r){function a(){this.mapping={A:t,FORM:i,INPUT:n,IMG:s,SELECT:o,TEXTAREA:r}}return a.prototype.bind=function(e,t){var i,n,s;for(i=0;i<e.childNodes.length;i++)n=e.childNodes[i],n.binding=this.bind(n,t);e.binding=this.create(e,t);for(s in e.dataset)e.binding[s]=e.binding[s].bind(e.binding),e.binding[s](new Function("return "+e.dataset[s]))},a.prototype.create=function(t,i){var n=e;return t.tagName in this.mapping&&(n=this.mapping[t.tagName]),new n(t,i)},new a}),n("joga/elementProperty",["joga/objectProperty","joga/dependencyTracker","joga/elementBinder"],function(e,t,i){function n(t){function i(e){return i.evaluate(e,this)}return e().mixinTo(i),i.evaluate=s,i.initialize(t),i}function s(e,n){return this.self=n,e?(this.initialValue=e,this.value=null,this.notify(),this.self):(null===this.value&&(t.push(function(){}),this.value=o(this.initialValue),i.bind(this.value,this.self),t.pop()),t.notify(this),this.value)}function o(e){var t;return e instanceof Node?e:(t=document.createElement("div"),t.innerHTML=e,t.firstChild)}return n}),n("joga/stringProperty",["joga/objectProperty"],function(e){function t(t){function r(e){return r.evaluate(e,this)}return e().mixinTo(r),r.isBlank=i,r.isNotBlank=n,r.isEmpty=s,r.isNotEmpty=o,r.initialize(t),r}function i(){return null===this.applySelf()||""===this.applySelf().trim()}function n(){return!this.isBlank()}function s(){return null===this.applySelf()||""===this.applySelf()}function o(){return!this.isEmpty()}return t}),n("joga",["joga/arrayProperty","joga/booleanProperty","joga/computedProperty","joga/dependencyTracker","joga/elementBinder","joga/bindings/ElementBinding","joga/bindings/HTMLAnchorElementBinding","joga/bindings/HTMLFormElementBinding","joga/bindings/HTMLImageElementBinding","joga/bindings/HTMLInputElementBinding","joga/bindings/HTMLSelectElementBinding","joga/bindings/HTMLTextAreaElementBinding","joga/elementProperty","joga/objectProperty","joga/stringProperty"],function(t,i,n,s,o,r,a,l,h,u,c,p,d,f,m){e();var g={dependencyTracker:s,elementBinder:o,ElementBinding:r,HTMLAnchorElementBinding:a,HTMLFormElementBinding:l,HTMLImageElementBinding:h,HTMLInputElementBinding:u,HTMLSelectElementBinding:c,HTMLTextAreaElementBinding:p,arrayProperty:t,booleanProperty:i,computedProperty:n,elementProperty:d,objectProperty:f,stringProperty:m};return window.joga=g,g}),i(["joga"])}();